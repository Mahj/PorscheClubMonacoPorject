{"version":3,"sources":["../../src/pages/components/restaurant-menu/detail/detail.ts","../../src/pages/components/restaurant-menu/detail/detail.module.ts"],"names":[],"mappings":"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","file":"19.js","sourcesContent":["import { Component, ChangeDetectorRef  } from '@angular/core';\nimport { IonicPage, NavController, NavParams, ToastController, LoadingController, ModalController, AlertController } from 'ionic-angular';\nimport { AngularFireDatabase, FirebaseListObservable } from 'angularfire2/database-deprecated';\nimport 'rxjs/add/operator/map'; // you might need to import this, or not depends on your setup\nimport { DatabaseProvider } from '../../../../providers/database/database';\nimport { Observable } from \"rxjs/Observable\";\nimport { GalleryModal } from \"ionic-gallery-modal\";\nimport { AngularFireAuth } from \"angularfire2/auth\";\n\n@IonicPage({\n    name: 'RestaurantDetailPage',\n    segment: 'restaurant-detail-page'\n})\n@Component({\n  selector: 'page-detail',\n  templateUrl: 'detail.html'\n})\nexport class RestaurantDetailPage {\n    uid: string;\n    prodName: any;\n    subDoc: any;\n    totalItemsInCart: number;\n\n  itemId: any;\n  item: any;\n  itemOption: FirebaseListObservable<any[]>;\n  itemSize: FirebaseListObservable<any[]>;\n\n  itemOptionArray: any=[]; \n  itemSizeArray: any = [];\n  favorite: boolean = false;\n    \n  showToolbar:boolean = false;\n  transition:boolean = false;\n  headerImgSize:string = '100%';\n  headerImgUrl:string = '';\n\n  constructor(public navCtrl: NavController, public navParams: NavParams, public loadingCtrl: LoadingController, public afDB: AngularFireDatabase, public ref: ChangeDetectorRef,\n      private toastCtrl: ToastController, public db: DatabaseProvider, public modalCtrl: ModalController, public afAuth: AngularFireAuth, public alertCtrl: AlertController) {\n     \n      let loadingPopup = this.loadingCtrl.create({\n        spinner: 'crescent', \n        content: ''\n      });\n      loadingPopup.present();     \n\n      this.itemId = this.navParams.get('itemId');\n      this.subDoc = this.navParams.get('subDoc');\n      this.prodName = this.navParams.get('prodName');\n      \n      let that = this;\n      db.getSubCategoryDocByname('restaurant', this.itemId, 'sub', this.subDoc)\n          .then(function (e) {\n              if (!!e) {\n                  console.log(e);\n                  that.item = e;\n                  that.itemOption = <FirebaseListObservable<any>>Observable.of(e.options);\n                  that.itemOptionArray = e.options || [];\n                  that.itemSize = <FirebaseListObservable<any>>Observable.of(e.size);\n                  that.itemSizeArray = e.size || [];\n              }\n              loadingPopup.dismiss()\n          });\n      \n      this.getTotalItemsOnCart();\n  }\n\n\n  onScroll($event: any){\n        let scrollTop = $event.scrollTop;\n        this.showToolbar = scrollTop >= 100;\n        if(scrollTop < 0){\n            this.transition = false;\n            this.headerImgSize = `${ Math.abs(scrollTop)/2 + 100}%`;\n        }else{\n            this.transition = true;\n            this.headerImgSize = '100%'\n        }\n        this.ref.detectChanges();\n  }\n\n\n  addToFav() {\n      this.favorite = !this.favorite;\n      this.presentToast('bottom', 'Add to Favorite');\n  }\n\n  presentToast(position: string, message: string) {\n      let toast = this.toastCtrl.create({\n          message: message,\n          position: position,\n          duration: 1000\n      });\n      toast.present();\n  }\n\n  fullscreenImage(getImage) {\n      let modal = this.modalCtrl.create(GalleryModal, {\n          // For multiple images //\n          //photos: this.imgGalleryArray,\n          // For single image //\n          photos: [{ url: getImage }],\n          closeIcon: 'close-circle',\n          //initialSlide: getIndex\n      });\n      modal.present();\n  }\n\n\n  getTotalItemsOnCart() {\n      let that = this;\n      this.afAuth.authState.subscribe(userAuth => {\n\n          if (userAuth) {\n              this.uid = !!userAuth ? userAuth.uid : null;\n              this.db.getDocuments('cart', ['uid', '==', this.uid])\n                  .then(function (e) {\n                      if (!!e) {\n                          let cart = e.filter((x) => {\n                              return !x.bought\n                          });\n                          \n                          that.totalItemsInCart = cart.length;\n                      }\n                  });\n          }\n      });\n  }\n\n  addToCart() {\n\n      this.afAuth.authState.subscribe(userAuth => {\n          if (!userAuth) {\n              this.showLoginChoices();\n              return;\n          }\n\n          this.uid = userAuth.uid;\n          let price = !!this.item.discount ? this.item.discountPrice : this.item.price;\n\n          this.db.getDocuments('cart', ['uid', '==', userAuth.uid]).then((x) => {\n\n              if (!!x || (!!x && x.length > 0)) {\n                  \n                  var exist = x.filter((i) => {\n                      return i.itemKey == this.subDoc;\n                  })\n\n                  if (!!exist && exist.length > 0) {\n                      //item already added to the cart\n                      const toast = this.toastCtrl.create({\n                          message: 'Item already added to the cart',\n                          position: 'bottom',\n                          duration: 3000\n                      });\n                      toast.present();\n                      return;\n                  }\n              }\n\n              this.db.addDocument('cart', {\n                  type: this.item.type,\n                  categoryKey: this.itemId,\n                  itemKey: this.subDoc,\n                  img: this.item.imgSmall,\n                  price: price,\n                  name: this.item.name,\n                  uid: this.uid,\n                  qty: 1\n              }).then(() => {\n                  const toast = this.toastCtrl.create({\n                      message: 'Item added to cart',\n                      position: 'bottom',\n                      duration: 3000\n                  });\n                  toast.present();\n                  this.getTotalItemsOnCart();\n\n              });\n\n          });\n\n\n      });\n  }\n\n\n  showLoginChoices() {\n      let prompt = this.alertCtrl.create({\n          title: 'Login',\n          message: \"You need to login to see your products in the cart, please select a login method\",\n\n          buttons: [\n              {\n                  text: 'Email/Pass login',\n                  handler: data => {\n                      this.navCtrl.push('LoginPage');\n                  }\n              },\n              {\n                  text: 'Social Login',\n                  handler: data => {\n                      this.navCtrl.push('NativeLoginPage');\n                  }\n              }\n          ]\n      });\n      prompt.present();\n  }\n\n  buyNow() {\n      this.navCtrl.push('CartPage');\n  }\n\n    \n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/components/restaurant-menu/detail/detail.ts","import { NgModule } from '@angular/core';\nimport { RestaurantDetailPage } from './detail';\nimport { IonicPageModule } from 'ionic-angular';\n\n@NgModule({\n  declarations: [\n      RestaurantDetailPage,\n  ],\n  imports: [\n      IonicPageModule.forChild(RestaurantDetailPage),\n  ],\n  exports: [\n      RestaurantDetailPage\n  ]\n})\nexport class RestaurantDetailPageModule {}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/components/restaurant-menu/detail/detail.module.ts"],"sourceRoot":""}