{"version":3,"sources":["../../src/pages/components/shopping/list/list.ts","../../src/pages/components/shopping/list/list.module.ts"],"names":[],"mappings":"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","file":"13.js","sourcesContent":["import { Component } from '@angular/core';\nimport { IonicPage, NavController, NavParams, LoadingController, ToastController, AlertController } from 'ionic-angular';\nimport { AngularFireDatabase } from 'angularfire2/database-deprecated';\nimport { DatabaseProvider } from '../../../../providers/database/database';\nimport { AngularFireAuth } from \"angularfire2/auth\";\n\n\n@IonicPage({\n    name: 'ShoppingListPage',\n    segment: 'shopping-list-page'\n})\n@Component({\n  selector: 'page-list',\n  templateUrl: 'list.html'\n})\nexport class ShoppingListPage {\n    uid: string;\n    favorite: any = [];\n    name: string;\n  categoryId:any;\n  items: any[] = [];\n  searchTerm: string = '';\n  filteredItems: any; \n  totalItemsInCart: number;\n\n  constructor(public navCtrl: NavController, public navParams: NavParams, public loadingCtrl: LoadingController, public afDB: AngularFireDatabase, public db: DatabaseProvider,\n      private toastCtrl: ToastController, public afAuth: AngularFireAuth, public alertCtrl: AlertController) {\n      let loadingPopup = this.loadingCtrl.create({\n        spinner: 'crescent',\n        content: ''\n      });\n      \n      this.categoryId =  this.navParams.get('categoryId');\n      this.name = this.navParams.get('name');\n   \n      console.log(this.categoryId);\n      if (this.categoryId == undefined)\n          return;\n\n      loadingPopup.present();\n      let that = this;\n      db.getSubCategoryDocs('shopping', this.categoryId, 'sub')\n          .then(function (e) {\n              if (!!e) {\n                  console.log(e)\n                  that.items = e;\n                  that.setFilteredItems();\n              }\n              loadingPopup.dismiss()\n          });\n\n      this.getTotalItemsOnCart();\n}\n\n  goToDetail(subDoc) {\n      this.navCtrl.push('ShoppingDetailPage', { itemId: this.categoryId, subDoc: subDoc }); \n  }\n\n  setFilteredItems() {\n      this.filteredItems = this.filterItems(this.items, this.searchTerm);\n  }\n\n  filterItems(items, searchTerm) {\n      //debugger;\n      if (searchTerm != '') {\n          return items.filter((item) => {\n              return item.name.toLowerCase().indexOf(searchTerm.toLowerCase()) > -1;\n          });\n      } else {\n          return items;\n      }\n  }\n\n  addToFav(key) {\n      this.favorite[key] = !this.favorite[key];\n      this.presentToast('bottom', 'Add to Favorite');\n  }\n\n\n  presentToast(position: string, message: string) {\n      let toast = this.toastCtrl.create({\n          message: message,\n          position: position,\n          duration: 1000\n      });\n      toast.present();\n  }\n\n  buyNow(position: string) {\n      this.navCtrl.push('CartPage');\n  }\n\n  addToCart(item) {\n      let that = this;\n      this.afAuth.authState.subscribe(userAuth => {\n          if (!userAuth) {\n              this.showLoginChoices();\n              return;\n          }\n\n          this.uid = userAuth.uid;\n          let price = !!item.discount ? item.discountPrice : item.price;\n       \n          this.db.getDocuments('cart', ['uid', '==', userAuth.uid]).then((x) => {\n              if (!!x || (!!x && x.length > 0)) {\n                  var exist = x.filter((i) => {\n                      return i.itemKey == item.$key;\n                  })\n\n                  if (!!exist && exist.length > 0) {\n                      //item already added to the cart\n                      const toast = this.toastCtrl.create({\n                          message: 'Item already added to the cart',\n                          position: 'bottom',\n                          duration: 3000\n                      });\n                      toast.present();\n                      return;\n                  }\n              }\n\n              this.db.addDocument('cart', {\n                  type: item.type,\n                  categoryKey: this.categoryId,\n                  itemKey: item.$key,\n                  img: item.imgSmall,\n                  price: price,\n                  name: item.name,\n                  uid: this.uid,\n                  qty: 1\n              }).then(() => {\n                  const toast = this.toastCtrl.create({\n                      message: 'Item added to cart',\n                      position: 'bottom',\n                      duration: 3000\n                  });\n                  toast.present();\n                  that.getTotalItemsOnCart();\n              });\n\n          });\n\n\n      });\n  }\n\n\n  showLoginChoices() {\n      let prompt = this.alertCtrl.create({\n          title: 'Login',\n          message: \"You need to login to see your products in the cart, please select a login method\",\n\n          buttons: [\n              {\n                  text: 'Email/Pass login',\n                  handler: data => {\n                      this.navCtrl.push('LoginPage');\n                  }\n              },\n              {\n                  text: 'Social Login',\n                  handler: data => {\n                      this.navCtrl.push('NativeLoginPage');\n                  }\n              }\n          ]\n      });\n      prompt.present();\n  }\n\n  getTotalItemsOnCart() {\n      let that = this;\n      this.afAuth.authState.subscribe(userAuth => {\n\n          if (userAuth) {\n              this.uid = !!userAuth ? userAuth.uid : null;\n              this.db.getDocuments('cart', ['uid', '==', this.uid])\n                  .then(function (e) {\n                      if (!!e) {\n                          let cart = e.filter((x) => {\n                              return !x.bought\n                          });\n\n                          that.totalItemsInCart = cart.length;\n                      }\n                  });\n          }\n      });\n  }\n\n\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/components/shopping/list/list.ts","import { NgModule } from '@angular/core';\nimport { ShoppingListPage } from './list';\nimport { IonicPageModule } from 'ionic-angular';\n\n@NgModule({\n  declarations: [\n      ShoppingListPage,\n  ],\n  imports: [\n      IonicPageModule.forChild(ShoppingListPage),\n  ],\n  exports: [\n      ShoppingListPage\n  ]\n})\nexport class ShoppingListPageModule {}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/components/shopping/list/list.module.ts"],"sourceRoot":""}